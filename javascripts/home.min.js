/*! home.min.js 2014-11-09 */
!function(a,b){function c(b,c,d,e){var f={duration:1,animation:null,iterate:1,timing:"linear",keep:!1};this.prefixes=["","-moz-","-o-animation-","-webkit-"],this.element=a(b),this.bare=b,this.queue=[],this.listening=!1;var g="function"==typeof d?d:e;switch(c){case"blur":f={amount:3,duration:.5,focusAfter:null},this.options=a.extend(f,d),this._blur(g);break;case"focus":this._focus();break;case"rotate":f={degrees:15,duration:.5},this.options=a.extend(f,d),this._rotate(g);break;case"cleanse":this.cleanse();break;default:this.options=a.extend(f,c),this.init(g)}}c.prototype={init:function(b){var c=this;"[object Array]"===Object.prototype.toString.call(c.options.animation)?a.merge(c.queue,c.options.animation):c.queue.push(c.options.animation),c.cleanse(),c.animate(b)},animate:function(a){this.element.addClass("animated"),this.element.addClass(this.queue[0]),this.element.data("animo",this.queue[0]);for(var b=this.prefixes.length;b--;)this.element.css(this.prefixes[b]+"animation-duration",this.options.duration+"s"),this.element.css(this.prefixes[b]+"animation-iteration-count",this.options.iterate),this.element.css(this.prefixes[b]+"animation-timing-function",this.options.timing);var c=this,d=a;c.queue.length>1&&(d=null),this._end("AnimationEnd",function(){c.element.hasClass(c.queue[0])&&(c.options.keep||c.cleanse(),c.queue.shift(),c.queue.length&&c.animate(a))},d)},cleanse:function(){this.element.removeClass("animated"),this.element.removeClass(this.queue[0]),this.element.removeClass(this.element.data("animo"));for(var a=this.prefixes.length;a--;)this.element.css(this.prefixes[a]+"animation-duration",""),this.element.css(this.prefixes[a]+"animation-iteration-count",""),this.element.css(this.prefixes[a]+"animation-timing-function",""),this.element.css(this.prefixes[a]+"transition",""),this.element.css(this.prefixes[a]+"transform",""),this.element.css(this.prefixes[a]+"filter","")},_blur:function(c){if(this.element.is("img")){var d="svg_"+(16777216*(1+Math.random())|0).toString(16).substring(1),e="filter_"+(16777216*(1+Math.random())|0).toString(16).substring(1);a("body").append('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" id="'+d+'" style="height:0;position:absolute;top:-1000px;"><filter id="'+e+'"><feGaussianBlur stdDeviation="'+this.options.amount+'" /></filter></svg>');for(var f=this.prefixes.length;f--;)this.element.css(this.prefixes[f]+"filter","blur("+this.options.amount+"px)"),this.element.css(this.prefixes[f]+"transition",this.options.duration+"s all linear");this.element.css("filter","url(#"+e+")"),this.element.data("svgid",d)}else{for(var g=this.element.css("color"),f=this.prefixes.length;f--;)this.element.css(this.prefixes[f]+"transition","all "+this.options.duration+"s linear");this.element.css("text-shadow","0 0 "+this.options.amount+"px "+g),this.element.css("color","transparent")}this._end("TransitionEnd",null,c);var h=this;if(this.options.focusAfter)var i=b.setTimeout(function(){h._focus(),i=b.clearTimeout(i)},1e3*this.options.focusAfter)},_focus:function(){var b=this.prefixes.length;if(this.element.is("img")){for(;b--;)this.element.css(this.prefixes[b]+"filter",""),this.element.css(this.prefixes[b]+"transition","");var c=a("#"+this.element.data("svgid"));c.remove()}else{for(;b--;)this.element.css(this.prefixes[b]+"transition","");this.element.css("text-shadow",""),this.element.css("color","")}},_rotate:function(a){for(var b=this.prefixes.length;b--;)this.element.css(this.prefixes[b]+"transition","all "+this.options.duration+"s linear"),this.element.css(this.prefixes[b]+"transform","rotate("+this.options.degrees+"deg)");this._end("TransitionEnd",null,a)},_end:function(a,b,c){var d=this,e=a.toLowerCase()+" webkit"+a+" o"+a+" MS"+a;this.element.bind(e,function(){d.element.unbind(e),"function"==typeof b&&b(),"function"==typeof c&&c(d)})}},a.fn.animo=function(a,b,d){return this.each(function(){new c(this,a,b,d)})}}(jQuery,window,document),$(function(){$.getJSON("http://api.xingwu.me/proposal/get_rose",function(a){0==a.ret&&$("#roseNum").text(a.roseNum)}),$("#roseBtn").on("click",function(){$.post("http://api.xingwu.me/proposal/add_rose"),$("#roseIcon").animo({animation:"tada",duration:2,iterate:1,keep:!1,timing:"ease-in-out"},function(){var a=$("#roseNum");a.text(parseInt(a.text())+1)});var a=document.createElement("img");a.src="/images/rose.png",a.style.top="0",a.style.left=Math.floor(80*Math.random())+"%",$("#roseCanvas").append(a),$(a).animo({animation:"rotateFadeOutDown"+(Math.random()>.5?1:2),duration:5,iterate:1,keep:!0,timing:"linear"},function(){$(a).remove()})})}),function(){function a(){WeixinJSBridge.invoke("sendAppMessage",{appid:h,img_url:d,img_width:"200",img_height:"200",link:e,desc:f,title:g},function(){})}function b(){WeixinJSBridge.invoke("shareTimeline",{img_url:d,img_width:"200",img_height:"200",link:e,desc:f,title:g},function(){})}function c(){WeixinJSBridge.invoke("shareWeibo",{content:f,url:e},function(){})}var d="http://proposal.xingwu.me/images/wx.jpg",e="http://proposal.xingwu.me/non-mobile.html",f="没想到伍行求婚的对象竟然是...？朋友们进来点个祝福吧:)",g="「 这份难寻的默契\n     让人生不再孤独 」",h="";document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.on("menu:share:appmessage",function(){a()}),WeixinJSBridge.on("menu:share:timeline",function(){b()}),WeixinJSBridge.on("menu:share:weibo",function(){c()})},!1)}(),function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-43935113-2","auto"),ga("send","pageview");
